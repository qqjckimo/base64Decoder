<!DOCTYPE html>
<html>
<head>
    <title>Worker Debug Test</title>
</head>
<body>
    <h1>Worker Debug Test</h1>
    <button id="testEncoder">Test Encoder Worker</button>
    <button id="testCompressor">Test Compressor Worker</button>
    <div id="output"></div>

    <script>
        const output = document.getElementById('output');
        
        function log(message) {
            output.innerHTML += '<div>' + message + '</div>';
            console.log(message);
        }

        // Test encoder worker
        document.getElementById('testEncoder').addEventListener('click', () => {
            log('üß™ Testing Encoder Worker...');
            
            try {
                const worker = new Worker('/workers/encoder.worker.worker.js');
                
                worker.onmessage = (e) => {
                    log('‚úÖ Encoder Worker Response: ' + JSON.stringify(e.data));
                };
                
                worker.onerror = (error) => {
                    log('‚ùå Encoder Worker Error: ' + error.message);
                };
                
                // Create test data
                const testData = new Uint8Array([137, 80, 78, 71, 13, 10, 26, 10]); // PNG signature
                
                worker.postMessage({
                    type: 'encode',
                    data: {
                        arrayBuffer: testData.buffer,
                        fileName: 'test.png',
                        fileSize: testData.length,
                        fileType: 'image/png',
                        includePrefix: true
                    },
                    id: 'test-encode-' + Date.now()
                });
                
                log('üì§ Test message sent to encoder worker');
                
            } catch (error) {
                log('‚ùå Error creating encoder worker: ' + error.message);
            }
        });

        // Test compressor worker  
        document.getElementById('testCompressor').addEventListener('click', () => {
            log('üß™ Testing Compressor Worker...');
            
            try {
                const worker = new Worker('/workers/compressor.worker.worker.js');
                
                worker.onmessage = (e) => {
                    log('‚úÖ Compressor Worker Response: ' + JSON.stringify(e.data));
                };
                
                worker.onerror = (error) => {
                    log('‚ùå Compressor Worker Error: ' + error.message);
                };
                
                // Create test image data
                const testFile = new File(['test'], 'test.png', { type: 'image/png' });
                
                worker.postMessage({
                    type: 'compress',
                    data: {
                        file: testFile,
                        quality: 75,
                        formats: ['png', 'webp']
                    },
                    id: 'test-compress-' + Date.now()
                });
                
                log('üì§ Test message sent to compressor worker');
                
            } catch (error) {
                log('‚ùå Error creating compressor worker: ' + error.message);
            }
        });
    </script>
</body>
</html>